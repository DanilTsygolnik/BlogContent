# Как зарегистрировать свой домен

## Введение

Интернет - совокупность различных устройств (серверы, ПК, смартфоны и пр.), связанных друг с другом в единую сеть. Если устройство нестроено специальным образом, к нему можно подключиться  через интернет для обмена данными (например, чтобы загрузить или скачать файлы)

Подключение осущствляется с помощью IP - идентификатора, однозначно соответствующего нужному устройству. Пример IP: `195.238.126.74`

Домен, или доменное имя - это тоже идентификатор, но более удобный для человеческого восприятия. Пример домена: `google.com`.

Чтобы к устройству можно было подключиться с помощью доменного имени:
1) доменное имя должно присутствовать в реестре;
2) доменное имя должно быть привязано к IP соответствующего устройства;

Подробнее о реестре, доменах и регистраторах - в [заметке](DomainNameRegistry.md)


## Выбор сервиса регистрации доменов

Поскольку добавление доменного имени в реестр производится организацией-регистратором, и в первую очередь нужно выбрать поставщика данной услуги.

На момент написания статьи оплата зарубежных сервисов из РФ могла быть затруднена. Доменное имя требовалось для экспериментов, и чтобы сэкономить время, я сразу выбирал из наиболее популярных сервисов в ru-сегменте. Мой выбор пал на reg.ru по следующим причинам:
1. Выгодные цены.
2. Возможность заказа минимума необходимых опций.
3. В отличие от других сервисов, с помощью справочной базы reg.ru удалось прояснить все непонятные моменты.
4. Наиболее понятное описание тарифов и услуг при оформлении заявки.

Для регистрации на сайте требуется только email и согласие с [политикой обработки персональных данных](https://www.reg.ru/company/privacy).


## Регистрация и привязка домена

Зарегистрировать можно только свободное доменное имя.

Определить незанятй домен можно онлайн (например, [здесь](https://www.reg.ru/domain/new/bulk)), или с помощью терминальной утилиты `whois`:
```bash
# Пример установки под Arch Linux
$ pacman -S whois

# Если доменное имя зарегистрировано, утилита выведет о нём информацию
$ whois -H google.com 
#   Domain Name: GOOGLE.COM
#   Registry Domain ID: 2138514_DOMAIN_COM-VRSN
#   ...

# Результат для свободного доменного имени
$ whois -H petyavasya.xyz
# The queried object does not exist: DOMAIN NOT FOUND
# ...
```

В описании зарегистрированного доменного имени содержатся личные данные владельца (ФИО, номер телефона, адрес проживания и др.), которые не хотелось бы выставлять на всеобщее обозрение. Для зон .ru .рф эти данные полность скрываются, и в т.ч. поэтому я выбрал домен `vpsprac.ru`. Для других зон правила регистрации допускают лишь частичное сокрытие этих данных или запрещают его вовсе, и это нужно учитывать.

Обзор оферты сервиса, правил регистрации домена (в т.ч. про сокрытие персональных данных) - в [заметке](/home/dt/work/git_projects/BlogContent/WebDev/DomainAdminPrivacy.md)


Полезно знать о правилах и сроках отмены регистрации доменного имени. Для reg.ru об этом можно прочитать [здесь](https://help.reg.ru/hc/ru/articles/4408047109777-%D0%9E%D1%88%D0%B8%D0%B1%D0%BE%D1%87%D0%BD%D0%BE-%D0%B7%D0%B0%D1%80%D0%B5%D0%B3%D0%B8%D1%81%D1%82%D1%80%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BB-%D0%B4%D0%BE%D0%BC%D0%B5%D0%BD-%D0%BC%D0%BE%D0%B6%D0%BD%D0%BE-%D0%BB%D0%B8-%D0%BE%D1%82%D0%BC%D0%B5%D0%BD%D0%B8%D1%82%D1%8C).


Регистрация производится в несколько простых шагов. У reg.ru на этот счёт есть понятный [гайд](https://help.reg.ru/hc/ru/articles/4408054420753-%D0%9A%D0%B0%D0%BA-%D0%B7%D0%B0%D1%80%D0%B5%D0%B3%D0%B8%D1%81%D1%82%D1%80%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D1%82%D1%8C-%D0%B4%D0%BE%D0%BC%D0%B5%D0%BD), делал по нему.


## Привязка зарегистрированного доменного имени к IP

Т.к. я впервые разбирался в теме, то вначале немного запулся: есть ли разница между "привязать домен к хостингу" и "привязать домен к IP VPS"? -- Нет, в сущности, это одно и то же.

Дело в том, что привязку домена к хостингу можно осуществлять несколькими способами, и один из них включает те же самые шаги, что и в случае с VPS.

Как быть:
- если работаем с хостингом, выбираем подходящий способ [отсюда](https://help.reg.ru/hc/ru/articles/4408046889745-%D0%9A%D0%B0%D0%BA-%D0%BF%D1%80%D0%B8%D0%B2%D1%8F%D0%B7%D0%B0%D1%82%D1%8C-%D0%B4%D0%BE%D0%BC%D0%B5%D0%BD-%D0%BA-%D1%85%D0%BE%D1%81%D1%82%D0%B8%D0%BD%D0%B3%D1%83);
- если работаем с VPS, выбираем в ЛК нужный домен и делаем по [гайду](https://help.reg.ru/hc/ru/articles/4408047107089-%D0%9A%D0%B0%D0%BA-%D0%BF%D1%80%D0%B8%D0%B2%D1%8F%D0%B7%D0%B0%D1%82%D1%8C-%D0%B4%D0%BE%D0%BC%D0%B5%D0%BD-%D0%BA-IP-%D0%B0%D0%B4%D1%80%D0%B5%D1%81%D1%83):
    1. Прописываем DNS-серверы ns1.reg.ru и ns2.reg.ru -- это дефолтный универсальный вариант из [рекомендаций](https://help.reg.ru/hc/ru/articles/4408047100945-%D0%9A%D0%B0%D0%BA%D0%B8%D0%B5-DNS-%D1%81%D0%B5%D1%80%D0%B2%D0%B5%D1%80%D1%8B-%D0%BF%D1%80%D0%BE%D0%BF%D0%B8%D1%81%D0%B0%D1%82%D1%8C-%D0%B4%D0%BB%D1%8F-%D0%B4%D0%BE%D0%BC%D0%B5%D0%BD%D0%B0) (см. раздел "Универсальный").
    2. Прописываем нужные ресурсные записи

После настройки ресурсных записей может потребоваться до 24 часов на обновление DNS-серверов, чтобы произошла привязка домена к указанному IP.

Если всё настроено правильно, домен должен успешно пинговаться. К примеру, до регистрации домена:
```bash
$ ping vpsprac.ru
#ping: vpsprac.ru: Name or service not known
```

После регистрации, для экспериментов были прописаны несколько А- и CNAME-записей, связывающих домен `vpsprac.ru` c IP VPS, на котором у меня поднят VPN.

Сервер успешно пингуется, но, как и следовало ожидать, только при подключении ПК к интернету через VPN:
```bash
# VPN отключен
$ ping vpsprac.ru
# PING vpsprac.ru (195.238.126.74) 56(84) bytes of data.
# ^C (прерываю передачу пакетов Ctrl+C)
# --- vpsprac.ru ping statistics ---
# 5 packets transmitted, 0 received, 100% packet loss, time 4057ms

# VPN активирован
$ ping vpsprac.ru
# PING vpsprac.ru (195.238.126.74) 56(84) bytes of data.
# 64 bytes from vm619481.melbi.space (195.238.126.74): icmp_seq=1 ttl=64 time=32.9 ms
# 64 bytes from vm619481.melbi.space (195.238.126.74): icmp_seq=2 ttl=64 time=33.4 ms
# 64 bytes from vm619481.melbi.space (195.238.126.74): icmp_seq=3 ttl=64 time=36.9 ms
# ^C (прерываю передачу пакетов Ctrl+C)
# --- vpsprac.ru ping statistics ---
# 3 packets transmitted, 3 received, 0% packet loss, time 2004ms
# rtt min/avg/max/mdev = 32.874/34.388/36.918/1.800 ms
```

Домен готов для использования в дальнейших экспериментах.


Дополнительные материалы для общего понимания:
- [что такое DNS и как это работает](https://help.reg.ru/hc/ru/articles/4408047119761-%D0%A7%D1%82%D0%BE-%D1%82%D0%B0%D0%BA%D0%BE%D0%B5-DNS-%D0%BF%D1%80%D0%BE%D1%81%D1%82%D1%8B%D0%BC%D0%B8-%D1%81%D0%BB%D0%BE%D0%B2%D0%B0%D0%BC%D0%B8) 
- [Ресурсные записи DNS: понятие, типы](https://help.reg.ru/hc/ru/articles/4408047057937-%D0%A7%D1%82%D0%BE-%D1%82%D0%B0%D0%BA%D0%BE%D0%B5-%D1%80%D0%B5%D1%81%D1%83%D1%80%D1%81%D0%BD%D1%8B%D0%B5-%D0%B7%D0%B0%D0%BF%D0%B8%D1%81%D0%B8-DNS) 
- gif-гайды по настройке ресурсных записей в ЛК reg.ru -- [статья](https://help.reg.ru/hc/ru/articles/4408047089169-%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0-%D1%80%D0%B5%D1%81%D1%83%D1%80%D1%81%D0%BD%D1%8B%D1%85-%D0%B7%D0%B0%D0%BF%D0%B8%D1%81%D0%B5%D0%B9-%D0%B2-%D0%9B%D0%B8%D1%87%D0%BD%D0%BE%D0%BC-%D0%BA%D0%B0%D0%B1%D0%B8%D0%BD%D0%B5%D1%82%D0%B5) 
- [Общая информация о делегировании доменных имён](https://help.reg.ru/hc/ru/articles/4408047025809-%D0%9E%D0%B1%D1%89%D0%B0%D1%8F-%D0%B8%D0%BD%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%86%D0%B8%D1%8F-%D0%BE-%D0%B4%D0%B5%D0%BB%D0%B5%D0%B3%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B8-%D0%B4%D0%BE%D0%BC%D0%B5%D0%BD%D0%BD%D1%8B%D1%85-%D0%B8%D0%BC%D1%91%D0%BD) 
- Прописал DNS-серверы и ресурсные записи, но сайт не работает -- [возможные решения](https://help.reg.ru/hc/ru/articles/4408054531857-%D0%9F%D1%80%D0%BE%D0%BF%D0%B8%D1%81%D0%B0%D0%BB-DNS-%D1%81%D0%B5%D1%80%D0%B2%D0%B5%D1%80%D1%8B-%D0%BD%D0%BE-%D1%81%D0%B0%D0%B9%D1%82-%D0%BD%D0%B5%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%B5%D0%BD) 
